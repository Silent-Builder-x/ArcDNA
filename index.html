<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ArcDNA | Confidential Genomic Matching</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        arcium: {
                            base: '#0B0F19',
                            panel: '#151b2b',
                            accent: '#3B82F6',
                            success: '#10B981',
                            text: '#94A3B8'
                        }
                    },
                    fontFamily: {
                        mono: ['"JetBrains Mono"', 'monospace'],
                        sans: ['Inter', 'sans-serif']
                    },
                    animation: {
                        'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'flow': 'flow 2s linear infinite',
                    },
                    keyframes: {
                        flow: {
                            '0%': { transform: 'translateX(-100%)' },
                            '100%': { transform: 'translateX(100%)' }
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@400;700&display=swap');
        
        body { background-color: #050505; color: #e2e8f0; font-family: 'Inter', sans-serif; overflow-x: hidden; }
        .glass { background: rgba(21, 27, 43, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(59, 130, 246, 0.1); }
        .glass-active { border-color: rgba(59, 130, 246, 0.4); box-shadow: 0 0 15px rgba(59, 130, 246, 0.15); }
        
        .node-connector {
            position: absolute; top: 50%; left: 0; width: 100%; height: 2px;
            background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.5), transparent);
            z-index: 0;
        }

        /* 滚动条 */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0B0F19; }
        ::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 3px; }
        
        .typing-cursor::after { content: '|'; animation: blink 1s step-end infinite; }
        @keyframes blink { 50% { opacity: 0; } }

        .sharding-particle {
            position: absolute; width: 4px; height: 4px; background: #3B82F6; border-radius: 50%;
            transition: all 1s ease-out;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col p-4 md:p-8 bg-[url('https://assets.arcium.com/grid.svg')] bg-fixed bg-cover">

    <!-- Header -->
    <header class="max-w-7xl mx-auto w-full flex justify-between items-end mb-8 border-b border-slate-800 pb-4">
        <div>
            <div class="flex items-center gap-3 mb-1">
                <i class="fas fa-dna text-blue-500 text-3xl"></i>
                <h1 class="text-3xl font-bold tracking-tight text-white">ArcDNA <span class="text-blue-500 text-sm font-mono align-top opacity-70">BETA</span></h1>
            </div>
            <p class="text-slate-500 text-xs font-mono tracking-widest uppercase">Confidential Genomic Matching Protocol</p>
        </div>
        <div class="flex gap-4">
            <div class="text-right hidden md:block">
                <p class="text-[10px] text-slate-500 uppercase font-bold">Network Status</p>
                <div class="flex items-center gap-2 justify-end">
                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                    <span class="text-xs font-mono text-green-400">Arcium Devnet</span>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto w-full grid grid-cols-1 lg:grid-cols-12 gap-6">
        
        <!-- LEFT: User Client (Input) -->
        <div class="lg:col-span-4 flex flex-col gap-6">
            <!-- DNA Generator Panel -->
            <div class="glass rounded-2xl p-6 relative overflow-hidden group">
                <div class="absolute top-0 left-0 w-1 h-full bg-blue-600"></div>
                <h2 class="text-sm font-bold text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2">
                    <i class="fas fa-user-shield"></i> Client Bio-Sample
                </h2>
                
                <div class="space-y-4">
                    <div class="bg-black/40 p-4 rounded-xl border border-slate-800 font-mono text-xs break-all relative h-24 overflow-hidden">
                        <div id="dna-sequence" class="text-slate-500 blur-[2px] transition-all duration-500">
                            AWAITING SEQUENCE GENERATION...
                        </div>
                        <div id="dna-overlay" class="absolute inset-0 flex items-center justify-center bg-black/20">
                            <i class="fas fa-lock text-slate-700"></i>
                        </div>
                    </div>

                    <div class="flex gap-2">
                        <button onclick="generateDNA()" id="btn-gen" class="flex-1 bg-slate-800 hover:bg-slate-700 text-white text-xs font-bold py-3 rounded-lg border border-slate-700 transition-all active:scale-95">
                            <i class="fas fa-fingerprint mr-2"></i> SYNTHESIZE
                        </button>
                        <button onclick="encryptData()" id="btn-enc" disabled class="flex-1 bg-blue-600 hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed text-white text-xs font-bold py-3 rounded-lg shadow-lg shadow-blue-900/20 transition-all active:scale-95">
                            <i class="fas fa-shield-alt mr-2"></i> ENCRYPT & SHARD
                        </button>
                    </div>
                </div>
            </div>

            <!-- Target Selection -->
            <div class="glass rounded-2xl p-6 opacity-50 transition-opacity" id="target-panel">
                <h2 class="text-sm font-bold text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2">
                    <i class="fas fa-bullseye"></i> Match Target
                </h2>
                <div class="flex items-center justify-between bg-slate-800/50 p-3 rounded-lg border border-slate-700 mb-4">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-full bg-slate-700 flex items-center justify-center">
                            <i class="fas fa-user-secret text-slate-400"></i>
                        </div>
                        <div>
                            <p class="text-xs font-bold text-white">Subject #8821</p>
                            <p class="text-[9px] text-slate-500">Hash: 8f2a...9c1</p>
                        </div>
                    </div>
                    <span class="px-2 py-1 rounded bg-slate-900 text-[9px] text-slate-400 border border-slate-700">ENCRYPTED</span>
                </div>
                <button onclick="runMPC()" id="btn-match" disabled class="w-full bg-emerald-600 hover:bg-emerald-500 disabled:opacity-50 disabled:bg-slate-800 text-white text-sm font-bold py-4 rounded-xl shadow-lg transition-all flex items-center justify-center gap-2 group">
                    <span id="match-text">INITIATE MPC MATCH</span>
                    <i class="fas fa-arrow-right group-hover:translate-x-1 transition-transform"></i>
                </button>
            </div>
        </div>

        <!-- CENTER: The "Blind" Computation Visualizer -->
        <div class="lg:col-span-5 flex flex-col">
            <div class="glass rounded-2xl flex-1 p-0 relative overflow-hidden flex flex-col">
                <!-- Header -->
                <div class="p-4 border-b border-slate-800 bg-slate-900/50 flex justify-between items-center">
                    <span class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Arcium MXE Cluster</span>
                    <span class="text-[9px] px-2 py-0.5 rounded bg-blue-900/30 text-blue-400 border border-blue-500/20">CONFIDENTIAL CONTEXT</span>
                </div>

                <!-- Visualization Canvas -->
                <div class="flex-1 relative bg-[#0B0F19] p-6 flex flex-col justify-center items-center gap-8" id="vis-container">
                    
                    <!-- Background Grid -->
                    <div class="absolute inset-0 bg-[linear-gradient(rgba(30,41,59,0.1)_1px,transparent_1px),linear-gradient(90deg,rgba(30,41,59,0.1)_1px,transparent_1px)] bg-[size:20px_20px]"></div>

                    <!-- Nodes -->
                    <div class="grid grid-cols-3 gap-8 w-full z-10">
                        <!-- Node 1 -->
                        <div id="node-1" class="node flex flex-col items-center gap-2 transition-all duration-500 opacity-30 scale-90">
                            <div class="w-12 h-12 rounded-lg border border-slate-700 bg-slate-900 flex items-center justify-center shadow-[0_0_15px_rgba(0,0,0,0.5)]">
                                <i class="fas fa-server text-slate-600 text-lg"></i>
                            </div>
                            <span class="text-[9px] font-mono text-slate-500">NODE ALPHA</span>
                            <div class="h-1 w-8 bg-slate-800 rounded-full overflow-hidden">
                                <div class="h-full bg-blue-500 w-0 transition-all duration-300"></div>
                            </div>
                        </div>
                        <!-- Node 2 -->
                        <div id="node-2" class="node flex flex-col items-center gap-2 transition-all duration-500 opacity-30 scale-90">
                            <div class="w-12 h-12 rounded-lg border border-slate-700 bg-slate-900 flex items-center justify-center shadow-[0_0_15px_rgba(0,0,0,0.5)]">
                                <i class="fas fa-server text-slate-600 text-lg"></i>
                            </div>
                            <span class="text-[9px] font-mono text-slate-500">NODE BETA</span>
                            <div class="h-1 w-8 bg-slate-800 rounded-full overflow-hidden">
                                <div class="h-full bg-blue-500 w-0 transition-all duration-300"></div>
                            </div>
                        </div>
                        <!-- Node 3 -->
                        <div id="node-3" class="node flex flex-col items-center gap-2 transition-all duration-500 opacity-30 scale-90">
                            <div class="w-12 h-12 rounded-lg border border-slate-700 bg-slate-900 flex items-center justify-center shadow-[0_0_15px_rgba(0,0,0,0.5)]">
                                <i class="fas fa-server text-slate-600 text-lg"></i>
                            </div>
                            <span class="text-[9px] font-mono text-slate-500">NODE GAMMA</span>
                            <div class="h-1 w-8 bg-slate-800 rounded-full overflow-hidden">
                                <div class="h-full bg-blue-500 w-0 transition-all duration-300"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Center Processor (The Circuit) -->
                    <div id="circuit-core" class="w-24 h-24 rounded-full border border-slate-700 bg-slate-900/80 flex items-center justify-center relative z-20 opacity-20">
                        <div class="absolute inset-0 border-2 border-dashed border-slate-600 rounded-full animate-[spin_10s_linear_infinite]"></div>
                        <i class="fas fa-microchip text-3xl text-slate-600"></i>
                    </div>

                    <!-- Message Status -->
                    <div id="vis-status" class="absolute bottom-4 font-mono text-[10px] text-slate-500 bg-black/50 px-3 py-1 rounded-full backdrop-blur-sm">
                        STATUS: IDLE
                    </div>

                </div>
            </div>
        </div>

        <!-- RIGHT: Logs & Result -->
        <div class="lg:col-span-3 flex flex-col gap-6">
            <!-- Terminal -->
            <div class="glass rounded-2xl flex-1 flex flex-col min-h-[300px]">
                <div class="p-3 border-b border-slate-800 bg-black/40 flex items-center gap-2">
                    <div class="flex gap-1.5">
                        <div class="w-2.5 h-2.5 rounded-full bg-slate-700"></div>
                        <div class="w-2.5 h-2.5 rounded-full bg-slate-700"></div>
                    </div>
                    <span class="text-[10px] font-mono text-slate-500 ml-2">program_logs.rs</span>
                </div>
                <div class="p-4 flex-1 font-mono text-[10px] leading-relaxed overflow-y-auto max-h-[400px]" id="logs">
                    <div class="text-slate-600 mb-2">ArcDNA Client v1.1.0 initialized...</div>
                    <div class="text-slate-600 mb-2">Connected to Solana Cluster via RPC.</div>
                    <div class="text-slate-600 mb-2">Waiting for input...</div>
                </div>
            </div>

            <!-- Final Result Card (Hidden initially) -->
            <div id="result-card" class="glass rounded-2xl p-6 border-l-4 border-emerald-500 transform translate-y-4 opacity-0 transition-all duration-700">
                <div class="flex items-start justify-between mb-2">
                    <div>
                        <p class="text-[10px] font-bold text-slate-500 uppercase">Computation Result</p>
                        <h3 class="text-xl font-bold text-white">Match Confirmed</h3>
                    </div>
                    <div class="bg-emerald-500/10 p-2 rounded-lg">
                        <i class="fas fa-check-double text-emerald-500"></i>
                    </div>
                </div>
                <p class="text-slate-400 text-xs mb-4">Genetic similarity exceeds threshold.</p>
                <div class="w-full bg-slate-800 rounded-full h-2 mb-2">
                    <div class="bg-emerald-500 h-2 rounded-full" style="width: 88%"></div>
                </div>
                <div class="flex justify-between text-[10px] font-mono text-slate-500 mb-4">
                    <span>Similarity: 88%</span>
                    <span>Proof: Valid</span>
                </div>
                <!-- Reset Button -->
                <button onclick="resetDemo()" class="w-full bg-slate-800 hover:bg-slate-700 text-slate-300 text-xs font-bold py-2 rounded border border-slate-700 transition-colors">
                    <i class="fas fa-redo-alt mr-2"></i> RESET SIMULATION
                </button>
            </div>
        </div>

    </main>

    <script>
        // DOM Elements
        const dnaDisplay = document.getElementById('dna-sequence');
        const dnaOverlay = document.getElementById('dna-overlay');
        const btnGen = document.getElementById('btn-gen');
        const btnEnc = document.getElementById('btn-enc');
        const btnMatch = document.getElementById('btn-match');
        const targetPanel = document.getElementById('target-panel');
        const logs = document.getElementById('logs');
        const nodes = [document.getElementById('node-1'), document.getElementById('node-2'), document.getElementById('node-3')];
        const circuitCore = document.getElementById('circuit-core');
        const resultCard = document.getElementById('result-card');
        const visStatus = document.getElementById('vis-status');
        const matchText = document.getElementById('match-text');

        let rawDNA = "";

        // Helper: Log
        function log(msg, type = 'info') {
            const el = document.createElement('div');
            const time = new Date().toLocaleTimeString('en-US', { hour12: false });
            el.innerHTML = `<span class="text-slate-600 mr-2">[${time}]</span> ${msg}`;
            
            if (type === 'success') el.className = 'text-emerald-400 mb-1';
            else if (type === 'warn') el.className = 'text-amber-400 mb-1';
            else if (type === 'error') el.className = 'text-red-400 mb-1';
            else el.className = 'text-blue-300 mb-1'; // standard info

            logs.appendChild(el);
            logs.scrollTop = logs.scrollHeight;
        }

        // Step 1: Generate
        function generateDNA() {
            rawDNA = Array(64).fill(0).map(() => "ACTG"[Math.floor(Math.random()*4)]).join('');
            let displayHTML = "";
            
            // Animation for generation
            let i = 0;
            dnaOverlay.style.opacity = '0';
            dnaDisplay.classList.remove('blur-[2px]');
            dnaDisplay.classList.remove('text-slate-500');
            dnaDisplay.classList.add('text-blue-400');
            
            const interval = setInterval(() => {
                displayHTML += rawDNA[i];
                dnaDisplay.innerText = displayHTML;
                i++;
                if (i >= 32) { // Show truncated
                    dnaDisplay.innerText = rawDNA.substring(0, 32) + "...";
                    clearInterval(interval);
                    btnEnc.disabled = false;
                    log("DNA Sequence synthesized locally from bio-sample.");
                    log("Warning: Data is currently RAW (Unsafe). Encrypt immediately.", "warn");
                }
            }, 20);
        }

        // Step 2: Encrypt (Sharding Visualization)
        function encryptData() {
            btnGen.disabled = true;
            btnEnc.disabled = true;
            
            log("Initializing Shamir's Secret Sharing scheme...");
            
            setTimeout(() => {
                // Visual Transform
                dnaDisplay.classList.add('blur-[2px]', 'text-slate-500');
                dnaDisplay.innerText = "0x8f2a1c...9d3e [ENCRYPTED]";
                dnaOverlay.style.opacity = '1';
                dnaOverlay.innerHTML = '<i class="fas fa-shield-alt text-emerald-500 text-xl"></i>';
                
                log("Data sharded into 3 parts.");
                log("Raw sequence wiped from memory.", "success");
                
                targetPanel.classList.remove('opacity-50');
                btnMatch.disabled = false;
            }, 1000);
        }

        // Step 3: MPC Match
        function runMPC() {
            btnMatch.disabled = true;
            matchText.innerText = "COMPUTING...";
            
            // 1. Activate Nodes
            log("Uploading shards to Arcium MXE Cluster...");
            visStatus.innerText = "STATUS: SHARD DISTRIBUTION";
            
            nodes.forEach((n, i) => {
                setTimeout(() => {
                    n.classList.remove('opacity-30', 'scale-90');
                    n.classList.add('scale-105', 'border-blue-500');
                    n.querySelector('i').classList.replace('text-slate-600', 'text-blue-400');
                    n.querySelector('div:last-child > div').style.width = '100%';
                }, i * 300);
            });

            // 2. Circuit Execution
            setTimeout(() => {
                log("Nodes accepted shards. Initializing 'compute_dna_similarity'...");
                visStatus.innerText = "STATUS: EXECUTING CIRCUIT";
                
                circuitCore.classList.remove('opacity-20');
                circuitCore.classList.add('scale-110', 'border-blue-500', 'shadow-[0_0_30px_rgba(59,130,246,0.3)]');
                circuitCore.querySelector('i').classList.replace('text-slate-600', 'text-white');
                
                // Pulse effect connecting nodes to core
                nodes.forEach(n => n.classList.add('animate-pulse'));
            }, 1500);

            // 3. Calculation Logs
            setTimeout(() => log("Computing Hamming Distance (Homomorphic)..."), 2500);
            setTimeout(() => log("Verifying Node Signatures..."), 3500);

            // 4. Finalize
            setTimeout(() => {
                log("Consensus reached. Generating Proof...", "success");
                visStatus.innerText = "STATUS: COMPLETE";
                visStatus.classList.add('text-emerald-400');
                
                nodes.forEach(n => n.classList.remove('animate-pulse'));
                circuitCore.classList.remove('animate-pulse');
                
                showResult();
            }, 4500);
        }

        function showResult() {
            matchText.innerText = "MATCH COMPLETED";
            resultCard.classList.remove('opacity-0', 'translate-y-4');
            log("Result decrypted: Match Found (88%).", "success");
        }

        // Step 4: Reset
        function resetDemo() {
            // 1. DNA Panel Reset
            rawDNA = "";
            dnaDisplay.classList.add('blur-[2px]', 'text-slate-500');
            dnaDisplay.classList.remove('text-blue-400');
            dnaDisplay.innerText = "AWAITING SEQUENCE GENERATION...";
            dnaOverlay.style.opacity = '1';
            dnaOverlay.innerHTML = '<i class="fas fa-lock text-slate-700"></i>';
            btnGen.disabled = false;
            btnEnc.disabled = true;

            // 2. Target Panel Reset
            targetPanel.classList.add('opacity-50');
            btnMatch.disabled = true;
            matchText.innerText = "INITIATE MPC MATCH";

            // 3. Visualization Reset
            visStatus.innerText = "STATUS: IDLE";
            visStatus.classList.remove('text-emerald-400');

            nodes.forEach(n => {
                n.classList.add('opacity-30', 'scale-90');
                n.classList.remove('scale-105', 'border-blue-500', 'animate-pulse');
                n.querySelector('i').classList.replace('text-blue-400', 'text-slate-600');
                n.querySelector('div:last-child > div').style.width = '0';
            });

            circuitCore.classList.add('opacity-20');
            circuitCore.classList.remove('scale-110', 'border-blue-500', 'shadow-[0_0_30px_rgba(59,130,246,0.3)]', 'animate-pulse');
            circuitCore.querySelector('i').classList.replace('text-white', 'text-slate-600');

            // 4. Result Card Reset
            resultCard.classList.add('opacity-0', 'translate-y-4');

            // 5. Log
            log("------------------------------------------");
            log("System reset. Ready for new subject.");
        }

        // Init
        log("System Ready.");
    </script>
</body>
</html>